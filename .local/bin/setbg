#!/bin/sh

# Set (default) wallpaper and send a notification.
# Usage: setbg [ OPTS ] [ FILE ]
# OPTS:
# -d    link pic to #XDG_DATA_HOME/bg, i.e., default wallpaper.
# -q    don't send notification.

bgloc="${XDG_DATA_HOME:-$HOME/.local/share}/bg"

while getopts "dq" opt; do
    case ${opt} in
        d) default=1;;
        q) quiet=1;;
        ?) echo "Error: Invalid opt" && exit 2;;
    esac
done

file=$(for i in $@; do echo $i; done | grep -v "^-"|head -n1)
[ -z $file ] && file=$(realpath $bgloc) || file=$(realpath $file)

xwallpaper --zoom "$file" >/dev/null 2>&1|| exit 2

if [  ! -z $default ]; then
    rm $bgloc
    ln -s $file $bgloc
fi

if [ -z $quiet ]; then
    [ -z $default ] && notify-send -i "$file" "Wallpaper is set." || notify-send -i "$file" "Default wallpaper is set." 
fi
