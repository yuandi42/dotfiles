#!/bin/sh

# Set (default) wallpaper and send a notification.
# Usage: setbg [ OPTS ] [ FILE ]
# OPTS:
# -d    link pic to #XDG_DATA_HOME/bg, i.e., default wallpaper.
# -q    don't send notification.

bgloc="${XDG_DATA_HOME:-$HOME/.local/share}/bg"
default=0

while getopts "dq" opt; do
    case ${opt} in
        d) default=1;;
        q) quiet=1;;
        ?) echo "Error: Invalid opt" && exit 2;;
    esac
done

file=$(realpath $(for i in $@; do echo $i; done | grep -v "^-"|head -n1))

xwallpaper --zoom "$file" >/dev/null 2>&1|| exit 2

[ $default -eq 1 ] && rm "$bgloc" && ln -s $file "$bgloc"

if [ -z $quiet ]; then
    [ $default -eq 1 ] && notify-send -i "$file" "Default wallpaper is set." || notify-send -i "$file" "Wallpaper is set."
fi
