#!/usr/bin/sh
# show mpd status. WIP

color="^c#7c6f64^"
if [ $(pidof mpd) ]; then 
    # pidof -x sb-mpdup >/dev/null 2>&1 || sb-mpdup >/dev/null 2>&1 &
    pidof -x sb-mpdup >/dev/null 2>&1 || sb-mpdup >/dev/null 2>&1 
    stt=$(mpc status | grep '^\['| cut -d " " -f 1)
    case $BLOCK_BUTTON in
        1) mpc toggle >/dev/null 2>&1 ;;  # left click, pause/unpause
        # 2) mpc status |  ;;  # right click, show status
        2) pkill -RTMIN+20 dwmblocks;; 
        3) setsid -f "$TERMINAL" -e ncmpcpp ;;  # right click, pause/unpause
        4) mpc prev >/dev/null 2>&1  ;;  # scroll up, previous
        5) mpc next >/dev/null 2>&1  ;;  # scroll down, next
    esac
    case $stt in
        *pause*) icon=" PAUSED";;
        *play*) icon=" PLAYING"; color="^c#427b58^";;
        *) icon=" ??";;
    esac
else 
    case $BLOCK_BUTTON in
        1) mpd && pkill -RTMIN+20 dwmblocks;; 
        2) pkill -RTMIN+20 dwmblocks;; 
    esac
    icon=" NO MPD"
fi

printf "$color$icon^d^"
